---
title: json output from PHP
sticky: 999
comments: true
lang: en
draft: published
type: HEXO/post
sitemap: true
toc: false
tocOpen: true
indexing: true
display_tag_onHome: true
recommendedSection: false
donate: false
swiper: false
geolocation: 'Tokyo, Japan'
copyright: true
mathjax: false
share: true
tags:
  - migrated from rBlogger.2009
categories:
  - Work_仕事
  - Programming_開発
  - PHP
date: 2010-08-27 12:44:08
---

 <div class="note"><BR>  <strong>garydavis at gmail dot com</strong><br><BR>  <a href="http://www.php.net/manual/en/function.json-encode.php#95667">14-Jan-2010 03:38</a><BR>  <div class="text"><BR><div class="phpcode"><code><span class="html"><BR>If you are planning on using this function to serve a json file, it's <BR>important to note that the json generated by this function is not ready <BR>to be consumed by javascript until you wrap it in parens and add ";" to <BR>the end. <br><BR><br><BR>It took me a while to figure this out so I thought I'd save others the aggravation.<br><BR><br><BR><span class="default">&lt;?php<br><BR>&nbsp;&nbsp;&nbsp; header</span><span class="keyword">(</span><span class="string">'Content-Type: text/javascript; charset=utf8'</span><span class="keyword">);<br><BR>&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Access-Control-Allow-Origin: <a href="http://www.example.com/" rel="nofollow" target="_blank">http://www.example.com/</a>'</span><span class="keyword">);<br><BR>&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Access-Control-Max-Age: 3628800'</span><span class="keyword">);<br><BR>&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Access-Control-Allow-Methods: GET, POST, PUT, DELETE'</span><span class="keyword">);<br><BR>&nbsp;&nbsp;&nbsp; <br><BR>&nbsp;&nbsp;&nbsp; </span><span class="default">$file</span><span class="keyword">=</span><span class="string">'rss.xml'</span><span class="keyword">;<br><BR>&nbsp;&nbsp;&nbsp; </span><span class="default">$arr </span><span class="keyword">= </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);</span><span class="comment">//this creates an object from the xml file<br><BR>&nbsp;&nbsp;&nbsp; </span><span class="default">$json</span><span class="keyword">= </span><span class="string">'('</span><span class="keyword">.</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">).</span><span class="string">');'</span><span class="keyword">; </span><span class="comment">//must wrap in parens and end with semicolon<br><BR>&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'callback'</span><span class="keyword">].</span><span class="default">$json</span><span class="keyword">); </span><span class="comment">//callback is prepended for json-p<br><BR></span><span class="default">?&gt;</span><BR></span><BR></code></div><BR>  </div><BR> </div>
 